<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Z4Tech Interface]]></title>
  <subtitle><![CDATA[Tracking...]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://z4tech.github.io/"/>
  <updated>2015-09-26T15:53:53.000Z</updated>
  <id>http://z4tech.github.io/</id>
  
  <author>
    <name><![CDATA[Z4Tech]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[Static Server in Node.js]]></title>
    <link href="http://z4tech.github.io/2015-09-26/nodejsStaticServer/"/>
    <id>http://z4tech.github.io/2015-09-26/nodejsStaticServer/</id>
    <published>2015-09-26T14:56:08.000Z</published>
    <updated>2015-09-26T15:53:53.000Z</updated>
    <content type="html"><![CDATA[<p>From time to time, I need to host some static files to do some local jobs. One possible solution is to set up the config file of the server engine (eg. apache, nginx). However, you need to restart the engine or reload the config file, and you may encounter really annoying some errors. Recently, I found node.js server function is quite useful in doing such things. You can easily set up servers on different ports and easily change the path. Here is the simple code:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//server.js</span></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> parse = <span class="built_in">require</span>(<span class="string">'url'</span>).parse;</span><br><span class="line"><span class="keyword">var</span> join = <span class="built_in">require</span>(<span class="string">'path'</span>).join;</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> root = __dirname + <span class="string">'/public'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> url = parse(req.url);</span><br><span class="line">  <span class="keyword">var</span> path = join(root, url.pathname);</span><br><span class="line">  <span class="keyword">var</span> stream = fs.createReadStream(path);</span><br><span class="line">  stream.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">    res.statusCode = <span class="number">500</span>;</span><br><span class="line">    res.end(<span class="string">'Internal Server Error'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  stream.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>)</span>&#123;</span><br><span class="line">    res.write(chunk);</span><br><span class="line">  &#125;);</span><br><span class="line">  stream.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    res.end();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure><br>Just put your files in the <code>\public</code> folder and run <code>node server.js</code>. All things are done! You can check them out on <code>localhost:3000</code>.<br>A more elegant way is to utilize the <code>pipe()</code> mechanism:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//server.js</span></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> parse = <span class="built_in">require</span>(<span class="string">'url'</span>).parse;</span><br><span class="line"><span class="keyword">var</span> join = <span class="built_in">require</span>(<span class="string">'path'</span>).join;</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> root = __dirname + <span class="string">'/public'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> url = parse(req.url);</span><br><span class="line">  <span class="keyword">var</span> path = join(root, url.pathname);</span><br><span class="line">  <span class="keyword">var</span> stream = fs.createReadStream(path);</span><br><span class="line">  stream.pipe(res);</span><br><span class="line">  stream.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">    res.statusCode = <span class="number">500</span>;</span><br><span class="line">    res.end(<span class="string">'Internal Server Error'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure> </p>
<p>Very easy isn’t it?</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>From time to time, I need to host some static files to do some local jobs. One possible solution is to set up the config file of the serv]]>
    </summary>
    
      <category term="Node.js" scheme="http://z4tech.github.io/tags/Node-js/"/>
    
      <category term="Static Server" scheme="http://z4tech.github.io/tags/Static-Server/"/>
    
      <category term="Node.js" scheme="http://z4tech.github.io/categories/Node-js/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Convert Anki Flashcards into Gitbook]]></title>
    <link href="http://z4tech.github.io/2015-09-01/Anki2Gitbook/"/>
    <id>http://z4tech.github.io/2015-09-01/Anki2Gitbook/</id>
    <published>2015-09-01T08:42:41.000Z</published>
    <updated>2015-09-26T15:54:33.000Z</updated>
    <content type="html"><![CDATA[<p>Anki is a great flashcard tool for memorizing new words, and here how to convert the flashcard desk in anki to wordlists in pdf, epub and html.  This procedure is done on Mac OSX 10.10, and probably work similarly on other Unix system.</p>
<p>Recently I’ve been working on GRE vocabulary, and Anki is a well-known multi-platform app for this. There are many great sets of cards and sometimes you just want to use them else where such as creating some wordlist. And this time, I need some wordlists from GRE3000, a popular book in China. I bought the printed version, but it is in alphabetical order. Luckily someone has made an Anki desk for it!</p>
<p>The vocabulary desks <code>.apkg</code> files are just <code>.zip</code> packages, you can just unzip it with command line:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip the_desk_name.apkg</span><br></pre></td></tr></table></figure><br>There are several files there, what we need is the <code>.anki2</code> file which is basically a sqlite database. Change the extension to sqlite and you can do anything with it! I just open it up with the Firefox extension - SQLite Manager.  </p>
<p><img src="http://7xlifa.com1.z0.glb.clouddn.com/imganki-sql.png" alt="img SQLite Manager"></p>
<p>Run the following SQL query to get the data we need, and then save it as csv(with or without header).<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT sfld, flds FROM notes</span><br></pre></td></tr></table></figure>  </p>
<p>Then we need to set up the <code>gitbook</code> engine. Firstly, nodejs and npm is needed, following the guide on the <a href="http://nodejs.org/" target="_blank" rel="external">website</a>. And then install gitbook-cli and initialize a project.<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gitbook-cli -g&#10;cd your_workspace&#10;mkdir book&#10;cd book&#10;gitbook init&#10;cp list.csv .</span><br></pre></td></tr></table></figure>  </p>
<p>And then, I wrote a ruby script to generate the markdown files needed to create the book.<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'csv'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#size of the wordlists</span></span><br><span class="line">list_size = <span class="number">20.0</span></span><br><span class="line">words = <span class="constant">CSV</span>.read(<span class="string">'list.csv'</span>)</span><br><span class="line">words.delete_at(<span class="number">0</span>)  <span class="comment">#if there is a header line</span></span><br><span class="line">words = words.shuffle</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">summary = <span class="constant">File</span>.new(<span class="string">'SUMMARY.md'</span>, <span class="string">'w'</span>)</span><br><span class="line">summary.puts <span class="string">"#Content\n"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>..(words.length/list_size).ceil</span><br><span class="line">  file = <span class="constant">File</span>.new(<span class="string">'./src/List'</span>+i.to_s+<span class="string">'.md'</span>, <span class="string">'w'</span>)</span><br><span class="line">  file.puts <span class="string">"#List<span class="subst">#&#123;i&#125;</span>"</span></span><br><span class="line">  summary.puts <span class="string">"* [List<span class="subst">#&#123;i&#125;</span>](src/List<span class="subst">#&#123;i&#125;</span>.md)  "</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">#you might need to change this part to fit different desks</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>..list_size</span><br><span class="line">    file.puts <span class="string">"\n\n---\n\n"</span> <span class="keyword">unless</span> i == <span class="number">1</span></span><br><span class="line">    content = words.shift()</span><br><span class="line">    <span class="keyword">if</span> content.<span class="keyword">nil</span>?</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    file.puts content[<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  file.close</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">summary.close</span><br></pre></td></tr></table></figure>  </p>
<p>Save this script and execute it at the folder. And don’t forget to write something in the <code>README.md</code>. Now you can use <code>gitbook serve</code> to see the web version of the book.  </p>
<p>To make a file version, we need to <a href="http://calibre-ebook.com/download" target="_blank" rel="external">download</a> and install <code>Calibre</code> and use the <code>ebook-convert</code> tool inside. For Mac OSX, we need to add the tool to the <code>$PATH</code>.<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=$PATH:/Applications/calibre.app/Contents/MacOS</span><br></pre></td></tr></table></figure>  </p>
<p>Finally, we shall compile the book!<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ..&#10;gitbook epub /book</span><br></pre></td></tr></table></figure><br>And then you’ll see the book inside your work folder.</p>
<p>Have fun!</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Anki is a great flashcard tool for memorizing new words, and here how to convert the flashcard desk in anki to wordlists in pdf, epub and]]>
    </summary>
    
      <category term="gitbook" scheme="http://z4tech.github.io/tags/gitbook/"/>
    
      <category term="ruby" scheme="http://z4tech.github.io/tags/ruby/"/>
    
      <category term="Misc" scheme="http://z4tech.github.io/categories/Misc/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hello, World!]]></title>
    <link href="http://z4tech.github.io/2015-08-26/hello/"/>
    <id>http://z4tech.github.io/2015-08-26/hello/</id>
    <published>2015-08-26T02:48:28.000Z</published>
    <updated>2015-08-26T04:05:15.000Z</updated>
    <content type="html"><![CDATA[<p>This is my technical blog where I save my work and progress. Hope it will be helpful for someone, especially you.  </p>
]]></content>
    <summary type="html">
    <![CDATA[<p>This is my technical blog where I save my work and progress. Hope it will be helpful for someone, especially you.  </p>
]]>
    </summary>
    
  </entry>
  
</feed>
